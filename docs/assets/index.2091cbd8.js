import{t as $,d as C,c as x,i as v,a as E,b as N,S as O,Z as D,B as M,T as F,r as A}from"./vendor.f18f0a3f.js";const H=function(){const d=document.createElement("link").relList;if(d&&d.supports&&d.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))i(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const u of n.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function a(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function i(e){if(e.ep)return;e.ep=!0;const n=a(e);fetch(e.href,n)}};H();const P=$('<div><h1>Concats all the epub HTML files and shows in the sandboxed iframe</h1><h2>Select epub file</h2><input type="file" name=""><h2>Or type fetchable URL</h2><input type="text" placeholder="URL"> <button type="button">Fetch</button><br></div>'),_=$("<div></div>"),L=async c=>{const a=await new D(new M(c)).getEntries(),i=a.filter(t=>t.filename.endsWith(".opf"));if(i.length!==1)throw new Error("OPF confusion");const n=await i[0].getData?.(new F),r=[...new DOMParser().parseFromString(n,"text/xml").querySelectorAll("manifest item")].filter(t=>t.getAttribute("media-type")?.match(/html/)).map(t=>t.getAttribute("href")||"\u2705").map(t=>a.filter(l=>l.filename.endsWith(`/${t}`)?!0:l.filename===t)[0]).filter(t=>t),f=(await Promise.all(r.map(t=>t.getData?.(new F)))).map(t=>{let l=new DOMParser().parseFromString(t,"application/xhtml+xml");return l.querySelector("parsererror")&&(l=new DOMParser().parseFromString(t,"text/html")),l.querySelectorAll("a").forEach(S=>{S.hasAttribute("href")&&(S.href="#"+S.href)}),l.body.childNodes}),s=document.implementation.createDocument(null,"html"),m=s.createElement("html"),p=s.createElement("head"),h=s.createElement("body"),g=document.querySelector("link[rel='stylesheet']"),y=document.querySelector("style");return g?p.appendChild(g.cloneNode(!0)):y&&p.appendChild(y.cloneNode(!0)),f.forEach(t=>{const l=s.createElement("div");l.classList.add("html-page"),l.append(...t),h.appendChild(l)}),m.appendChild(p),m.appendChild(h),s.documentElement.append(m),s.documentElement.outerHTML},T=()=>{let c;const[d,a]=x(""),[i,e]=x("");async function n(){if(!c)return;const o=c.files?.[0];if(o){const r=await L(o);e(r)}}async function u(o){try{const r=await fetch(o),b=await L(await r.blob());e(b)}catch(r){r instanceof TypeError?a(r.name+": "+r.message):a("Unable to fetch")}}function w(){return(()=>{const o=P.cloneNode(!0),r=o.firstChild,b=r.nextSibling,f=b.nextSibling,s=f.nextSibling,m=s.nextSibling,p=m.nextSibling,h=p.nextSibling;h.nextSibling,f.$$input=n;const g=c;return typeof g=="function"?g(f):c=f,h.$$click=y=>{y.target.previousElementSibling instanceof HTMLInputElement&&u(y.target.previousElementSibling.value)},v(o,d,null),o})()}return(()=>{const o=_.cloneNode(!0);return v(o,E(O,{get when(){return i()},fallback:()=>E(w,{}),get children(){const r=_.cloneNode(!0);return N(()=>r.innerHTML=i()),r}})),o})()};C(["input","click"]);A(()=>E(T,{}),document.getElementById("root"));
