import{t as g,d as v,c as w,i as S,a as b,b as _,S as F,s as L,Z as A,B as N,T as $,r as O}from"./vendor.da65c12b.js";const C=function(){const a=document.createElement("link").relList;if(a&&a.supports&&a.supports("modulepreload"))return;for(const e of document.querySelectorAll('link[rel="modulepreload"]'))l(e);new MutationObserver(e=>{for(const n of e)if(n.type==="childList")for(const f of n.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&l(f)}).observe(document,{childList:!0,subtree:!0});function c(e){const n={};return e.integrity&&(n.integrity=e.integrity),e.referrerpolicy&&(n.referrerPolicy=e.referrerpolicy),e.crossorigin==="use-credentials"?n.credentials="include":e.crossorigin==="anonymous"?n.credentials="omit":n.credentials="same-origin",n}function l(e){if(e.ep)return;e.ep=!0;const n=c(e);fetch(e.href,n)}};C();const D=g('<div><h1>Concats all the epub HTML files and shows in the sandboxed iframe</h1><h2>Select epub file</h2><input type="file" name=""><h2>Or type fetchable URL</h2><input type="text" placeholder="URL"> <button type="button">Fetch</button><br></div>'),M=g('<iframe sandbox=""></iframe>'),P=g("<div></div>"),x=async s=>{const c=await new A(new N(s)).getEntries(),l=c.filter(t=>t.filename.endsWith(".opf"));if(l.length!==1)throw new Error("OPF confusion");const n=await l[0].getData?.(new $),r=[...new DOMParser().parseFromString(n,"text/xml").querySelectorAll("manifest item")].filter(t=>t.getAttribute("media-type")?.match(/html/)).map(t=>t.getAttribute("href")||"\u2705").map(t=>c.filter(i=>i.filename.endsWith(`/${t}`))[0]).filter(t=>t),d=(await Promise.all(r.map(t=>t.getData?.(new $)))).map(t=>{const i=new DOMParser().parseFromString(t,"text/html");return i.querySelectorAll("a").forEach(m=>{m.hasAttribute("href")&&(m.href="#"+m.href)}),i.body.childNodes}),u=document.implementation.createDocument(null,"html"),h=u.createElement("body");return u.documentElement.append(h),d.forEach(t=>{const i=u.createElement("div");i.append(...t),h.appendChild(i)}),u.documentElement.outerHTML},T=()=>{let s;const[a,c]=w(""),[l,e]=w("");async function n(){if(!s)return;const o=s.files?.[0];if(o){const r=await x(o);e(r)}}async function f(o){try{const r=await fetch(o),p=await x(await r.blob());e(p)}catch(r){r instanceof TypeError?c(r.name+": "+r.message):c("Unable to fetch")}}function y(){return(()=>{const o=D.cloneNode(!0),r=o.firstChild,p=r.nextSibling,d=p.nextSibling,u=d.nextSibling,h=u.nextSibling,t=h.nextSibling,i=t.nextSibling;i.nextSibling,d.$$input=n;const m=s;return typeof m=="function"?m(d):s=d,i.$$click=E=>{E.target.previousElementSibling instanceof HTMLInputElement&&f(E.target.previousElementSibling.value)},S(o,a,null),o})()}return(()=>{const o=P.cloneNode(!0);return S(o,b(F,{get when(){return l()},fallback:()=>b(y,{}),get children(){const r=M.cloneNode(!0);return _(()=>L(r,"srcdoc",l())),r}})),o})()};v(["input","click"]);O(()=>b(T,{}),document.getElementById("root"));
